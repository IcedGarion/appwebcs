@using School.Data
@using System.Collections.Generic
@using Microsoft.AspNetCore.Http
@inject IHttpContextAccessor HttpContextAccessor

@{
    ViewBag.Title = "LISTA ORDINI";
}

@model IEnumerable<OrdiniJoinDataSource>


<div class="container">
    <div class="header">
        <h2>Lista Ordini</h2>
    </div>

    <div class="main">

        <h4>Lista Prodotti</h4>

        <!-- FILTRO DATA -->
        @using (Html.BeginForm("List", "Ordine", FormMethod.Post))
        {
            <fieldset>
                <input type="text" name="start" id="start" value="@DateTime.Now" />Data inizio
                <input type="text" name="end" id="end" value="@DateTime.Now" />Data fine
                <input type="submit" value="Filtra Per Data" />
            </fieldset>
        }
        <input type="button" value="Pulisci Filtro"
               onclick="@("window.location.href='" + @Url.Action("List", "Ordine") + "'");" />



        <table border="1">
            <tr>

                <th>@Html.ActionLink("Codice ordine", "List", "Ordine", new { orderby = "CdOrdine" }, null)</th>
                <th>@Html.ActionLink("Titolo prodotto", "List", "Ordine", new { orderby = "Titolo" }, null)</th>
                <th>@Html.ActionLink("Quantita'", "List", "Ordine", new { orderby = "Quantita" }, null)</th>
                <th>@Html.ActionLink("Data", "List", "Ordine", new { orderby = "DtInserimento" }, null)</th>
                <th>@Html.ActionLink("Totale Ordine", "List", "Ordine", new { orderby = "Totale" }, null)</th>
                <th>@Html.ActionLink("Stato", "List", "Ordine", new { orderby = "Stato" }, null)</th>
            </tr>
    
            <!-- foreach (var group in Model.GroupBy(item => item.CdOrdine))
            { -->
                @foreach (var s in Model)
                {
                    <tr>
                        <td>@s.CdOrdine</td>
                        <td>@s.Titolo</td>
                        <td>@s.Quantita</td>
                        <td>@s.DtInserimento</td>
                        <td>@s.Totale</td>
                        <td>@s.Stato</td>

                        <td>
                            @using (Html.BeginForm("Update", "Ordine", FormMethod.Post))
                            {
                                <fieldset>
                                    <input type="text" name="ordine" id="ordine" value="@s.CdOrdine" hidden />
                                    <select name="stato" id="stato">
                                        <option value="sent">sent</option>
                                        <option value="processed">processed</option>
                                    </select>
                                    <input type="submit" value="Modifica Stato Ordine" />
                                </fieldset>
                            }
                        </td>
                    </tr>
                }
            }
        </table>
</div>

    <div class="footer">
        <h6>footer</h6>
    </div>
</div>

